<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metric Ladder Lab | Grade 9 Science</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --panel-color: #16213e;
            --accent-green: #0f3460;
            --highlight: #e94560;
            --text-light: #f1f1f1;
            --ladder-color: #4da8da;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-light);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 { border-bottom: 2px solid var(--highlight); padding-bottom: 10px; }

        .game-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 900px;
            width: 100%;
            justify-content: center;
        }

        /* --- THE LADDER VISUALIZER --- */
        .ladder-container {
            background: var(--panel-color);
            padding: 20px;
            border-radius: 10px;
            min-width: 250px;
            border: 1px solid var(--ladder-color);
        }

        .ladder-step {
            padding: 8px;
            margin: 4px 0;
            background: rgba(255,255,255,0.05);
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .ladder-step.active-from { background: var(--highlight); color: white; font-weight: bold; }
        .ladder-step.active-to { background: var(--ladder-color); color: black; font-weight: bold; }
        .ladder-step span { opacity: 0.7; }

        /* --- GAME INPUT AREA --- */
        .control-panel {
            flex: 1;
            background: var(--panel-color);
            padding: 30px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 300px;
        }

        .question-box {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        input {
            background: transparent;
            border: none;
            border-bottom: 2px solid var(--highlight);
            color: white;
            font-size: 1.5rem;
            width: 150px;
            text-align: center;
        }
        input:focus { outline: none; border-bottom-color: var(--ladder-color); }

        button {
            background: var(--highlight);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.1s;
        }
        button:hover { transform: scale(1.05); }

        /* --- FEEDBACK --- */
        .feedback {
            margin-top: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 5px;
            width: 100%;
            display: none;
        }
        
        .feedback.correct { border-left: 5px solid #00ff00; }
        .feedback.wrong { border-left: 5px solid #ff0000; }

        .explanation {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #ddd;
            line-height: 1.4;
        }

        .formula {
            font-family: monospace;
            background: rgba(255,255,255,0.1);
            padding: 2px 5px;
            border-radius: 3px;
        }

    </style>
</head>
<body>

    <h1>METRIC LADDER LAB</h1>
    <p>Use the ladder to calculate the "jumps" between units.</p>

    <div class="game-wrapper">
        
        <div class="ladder-container">
            <h3 style="text-align:center; margin-top:0;">Prefix Ladder</h3>
            <div id="step-6" class="ladder-step"><span>10⁶</span> Mega (M)</div>
            <div class="ladder-step" style="opacity:0.3; font-size:0.7rem;">...</div>
            <div id="step-3" class="ladder-step"><span>10³</span> kilo (k)</div>
            <div id="step-2" class="ladder-step"><span>10²</span> hecto (h)</div>
            <div id="step-1" class="ladder-step"><span>10¹</span> deca (da)</div>
            <div id="step-0" class="ladder-step"><span>10⁰</span> (BASE)</div>
            <div id="step--1" class="ladder-step"><span>10⁻¹</span> deci (d)</div>
            <div id="step--2" class="ladder-step"><span>10⁻²</span> centi (c)</div>
            <div id="step--3" class="ladder-step"><span>10⁻³</span> milli (m)</div>
            <div class="ladder-step" style="opacity:0.3; font-size:0.7rem;">...</div>
            <div id="step--6" class="ladder-step"><span>10⁻⁶</span> micro (µ)</div>
        </div>

        <div class="control-panel">
            <div class="question-box" id="question-display">
                Loading...
            </div>

            <div class="input-group">
                <span>=</span>
                <input type="text" id="user-input" placeholder="?" autocomplete="off">
                <span id="target-unit-label" style="font-size: 1.2rem; font-weight: bold;"></span>
            </div>

            <button onclick="checkAnswer()" id="action-btn">Check Conversion</button>

            <div id="feedback-area" class="feedback">
                <strong id="feedback-title"></strong>
                <div id="feedback-text" class="explanation"></div>
                <button onclick="nextQuestion()" style="margin-top:10px; background: var(--ladder-color);">Next Problem</button>
            </div>
        </div>
    </div>

<script>
    // --- CONFIGURATION ---
    // Prefixes mapped to their power of 10
    const prefixMap = {
        'M': 6,  // Mega
        'k': 3,  // kilo
        'h': 2,  // hecto
        'da': 1, // deca
        'base': 0, // meters, liters, grams
        'd': -1, // deci
        'c': -2, // centi
        'm': -3, // milli
        'µ': -6  // micro
    };

    // Questions directly from Source 42 (Review Sheet)
    const questions = [
        // Source 42: Level 2 & 3
        { val: 1456, uFrom: 'm', uTo: 'km' },
        { val: 1456, uFrom: 'm', uTo: 'cm' },
        { val: 15, uFrom: 'mL', uTo: 'L' },
        { val: 78.2, uFrom: 'kg', uTo: 'g' },
        { val: 1576, uFrom: 'µL', uTo: 'L' },
        { val: 147, uFrom: 'g', uTo: 'kg' },
        { val: 147, uFrom: 'g', uTo: 'mg' },
        { val: 147, uFrom: 'g', uTo: 'dg' },
        { val: 147, uFrom: 'g', uTo: 'Mg' }, // Mega-gram
        // Source 42: Level 4
        { val: 159, uFrom: 'hm', uTo: 'mm' },
        { val: 159, uFrom: 'hm', uTo: 'µm' },
        { val: 159, uFrom: 'hm', uTo: 'km' },
        { val: 189.3, uFrom: 'dL', uTo: 'daL' },
        { val: 189.3, uFrom: 'dL', uTo: 'cL' },
        { val: 189.3, uFrom: 'dL', uTo: 'ML' }, // Mega-liter
        { val: 189.3, uFrom: 'dL', uTo: 'mL' }
    ];

    let currentQ = null;

    // --- LOGIC ---

    function parseUnit(unitString) {
        // Return { prefix: 'k', power: 3 }
        if (unitString.length === 1) return { p: 'base', val: 0 }; // m, g, L
        
        // Handle "da" (deca) specifically as it is 2 chars
        if (unitString.startsWith('da')) return { p: 'da', val: 1 };
        
        // Handle standard 1 char prefixes
        let pChar = unitString.charAt(0);
        if (prefixMap.hasOwnProperty(pChar)) {
            return { p: pChar, val: prefixMap[pChar] };
        }
        
        // Fallback for base units if logic fails
        return { p: 'base', val: 0 };
    }

    function loadQuestion() {
        // Pick random or next
        currentQ = questions[Math.floor(Math.random() * questions.length)];

        // Display
        document.getElementById('question-display').innerHTML = 
            `Convert: <strong>${currentQ.val} ${currentQ.uFrom}</strong>`;
        document.getElementById('target-unit-label').innerText = currentQ.uTo;
        document.getElementById('user-input').value = '';
        
        // Reset UI
        document.getElementById('feedback-area').style.display = 'none';
        document.getElementById('action-btn').style.display = 'inline-block';
        
        highlightLadder();
    }

    function highlightLadder() {
        // Clear old highlights
        document.querySelectorAll('.ladder-step').forEach(el => {
            el.classList.remove('active-from', 'active-to');
        });

        // Get powers
        const fromInfo = parseUnit(currentQ.uFrom);
        const toInfo = parseUnit(currentQ.uTo);

        // Highlight
        const fromEl = document.getElementById(`step-${fromInfo.val}`);
        const toEl = document.getElementById(`step-${toInfo.val}`);

        if(fromEl) fromEl.classList.add('active-from'); // RED (Start)
        if(toEl) toEl.classList.add('active-to');       // BLUE (End)
    }

    function checkAnswer() {
        const inputStr = document.getElementById('user-input').value.replace(/,/g, ''); // Remove commas
        const inputVal = parseFloat(inputStr);
        
        if (isNaN(inputVal)) {
            alert("Please enter a number.");
            return;
        }

        // Calculate Correct Answer
        const fromInfo = parseUnit(currentQ.uFrom);
        const toInfo = parseUnit(currentQ.uTo);
        const powerDiff = fromInfo.val - toInfo.val; // e.g., hm(2) to mm(-3) = 5
        
        // Math: value * 10^(diff)
        const correctVal = currentQ.val * Math.pow(10, powerDiff);
        
        // Generate Explanation Text
        const direction = powerDiff > 0 ? "right" : "left";
        const steps = Math.abs(powerDiff);
        
        // Check with slight tolerance for float errors
        const isCorrect = Math.abs(inputVal - correctVal) < (correctVal * 0.00001) || inputVal === correctVal;

        // Display Feedback
        const fbArea = document.getElementById('feedback-area');
        const fbTitle = document.getElementById('feedback-title');
        const fbText = document.getElementById('feedback-text');

        fbArea.style.display = 'block';
        document.getElementById('action-btn').style.display = 'none';

        if (isCorrect) {
            fbArea.className = "feedback correct";
            fbTitle.innerText = "Correct!";
            fbText.innerHTML = `
                Start at <strong>${fromInfo.p === 'base' ? 'Base' : fromInfo.p} (10<sup>${fromInfo.val}</sup>)</strong>.<br>
                End at <strong>${toInfo.p === 'base' ? 'Base' : toInfo.p} (10<sup>${toInfo.val}</sup>)</strong>.<br>
                Difference is <strong>${steps} steps</strong> down the ladder.<br>
                Move decimal <strong>${steps} places ${direction}</strong>.
            `;
        } else {
            fbArea.className = "feedback wrong";
            fbTitle.innerText = "Try Again";
            // Format numbers to avoid scientific notation for readability if possible
            let displayCorrect = correctVal;
            if (steps > 4) displayCorrect = correctVal.toLocaleString(); 

            fbText.innerHTML = `
                Not quite. Look at the ladder:<br>
                1. Start: <strong>${fromInfo.p} (10<sup>${fromInfo.val}</sup>)</strong><br>
                2. End: <strong>${toInfo.p} (10<sup>${toInfo.val}</sup>)</strong><br>
                3. The gap is <strong>${steps} steps</strong>.<br>
                4. <span class="formula">${currentQ.val} × 10<sup>${powerDiff}</sup> = ${displayCorrect}</span>
            `;
        }
    }

    function nextQuestion() {
        loadQuestion();
    }

    // Init
    loadQuestion();

</script>
</body>
</html>
